<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ECharts 中国地图与柱状图</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <script src="https://echarts.apache.org/examples/data/asset/geo/china.json"></script>
</head>

<body>
  <div id="main" style="width: 800px;height:600px;"></div>
  <script>
    var chartDom = document.getElementById('main');
    var myChart = echarts.init(chartDom);
    var option;

    myChart.showLoading();
    echarts.registerMap('china', echarts.chinaJson);
    myChart.hideLoading();

    var data = [
      { name: '陕西西安', value: 12952907 },
      { name: '河南洛阳', value: 7056796 },
      { name: '河南开封', value: 4824016 },
      { name: '北京', value: 21886000 }
    ];

    data.sort(function (a, b) {
      return a.value - b.value;
    });

    const mapOption = {
      visualMap: {
        left: 'right',
        min: 4000000,
        max: 22000000,
        inRange: {
          color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
        },
        text: ['High', 'Low'],
        calculable: true
      },
      series: [
        {
          id: 'population',
          type: 'map',
          roam: true,
          map: 'china',
          animationDurationUpdate: 1000,
          universalTransition: true,
          data: data,
          markPoint: {
            data: [
              { name: '陕西西安', value: 12952907, coord: [108.94, 34.26] },
              { name: '河南洛阳', value: 7056796, coord: [112.44, 34.67] },
              { name: '河南开封', value: 4824016, coord: [114.35, 34.79] },
              { name: '北京', value: 21886000, coord: [116.40, 39.90] }
            ]
          }
        }
      ]
    };

    const barOption = {
      xAxis: {
        type: 'value'
      },
      yAxis: {
        type: 'category',
        axisLabel: {
          rotate: 30
        },
        data: data.map(function (item) {
          return item.name;
        })
      },
      animationDurationUpdate: 1000,
      series: {
        type: 'bar',
        id: 'population',
        data: data.map(function (item) {
          return item.value;
        }),
        universalTransition: true
      }
    };

    let currentOption = mapOption;
    myChart.setOption(mapOption);

    setInterval(function () {
      currentOption = currentOption === mapOption ? barOption : mapOption;
      myChart.setOption(currentOption, true);
    }, 2000);

    option && myChart.setOption(option);
  </script>
</body>

</html>